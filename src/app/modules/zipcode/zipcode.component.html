<div class="container-fluid">
  <div class="well" [formGroup]="zipCodeForm">
    <h2>Enter a zip code:</h2>
    <input
      formControlName="country"
      (keydown.enter)="zipCode.focus()"
      class="form-control"
      type="text"
      placeholder="Enter a country"
    />
    <br />
    <input
      #zipCode
      formControlName="zipCode"
      (keydown.enter)="zipCodeForm.valid && onSubmit()"
      class="form-control"
      placeholder="Enter a zip code"
      type="number"
    />
    <br />
    <weather-app-state-button
      [defaultTemplate]="defaultTemplate"
    ></weather-app-state-button>

    <ng-template #defaultTemplate>
      <button
        (click)="onSubmit()"
        class="btn btn-primary"
        [disabled]="!zipCodeForm.valid"
      >
        Add location
      </button>
    </ng-template>

    <p style="width: 100%; text-align: end" *ngIf="this.weatherList.length > 0">
      <i [weatherAppCountdownTimer]="autoRefresh$">Updating weather...</i>
    </p>
  </div>

  <ng-template
    [ngIf]="this.weatherList.length > 0"
    [ngIfElse]="elseNoLocationsTemplate"
  >
    <div *ngFor="let item of weatherList">
      <div class="well flex">
        <weather-app-loader-spinner
          *ngIf="(autoRefresh$ | async) === 0; else elseDisplayWeather"
          [text]="'Loading weather...'"
        ></weather-app-loader-spinner>

        <ng-template #elseDisplayWeather>
          <div>
            <h3>{{ item.city }}&nbsp;({{ item.zipCode }})</h3>
            <h4>Current conditions: {{ item.condition }}</h4>
            <h4>Temperatures today:</h4>
            <p>
              Current&nbsp;{{
                item.temperature | number: "1.0-0"
              }}&deg;&nbsp;-&nbsp;Max&nbsp;{{
                item.maxTemp | number: "1.0-0"
              }}&deg;&nbsp;-&nbsp;Min&nbsp;{{
                item.minTemp | number: "1.0-0"
              }}&deg;
            </p>
            <p>
              <a [routerLink]="['forecast', item.zipCode]"
                >Show 5-day forecast for {{ item.city }}</a
              >
            </p>
          </div>
          <div>
            <span class="close" (click)="deleteWeather(item)">Ã—</span>
            <img
              src="https://www.angulartraining.com/images/weather/{{
                item.icon
              }}.png"
            />
          </div>
        </ng-template>
      </div>
    </div>
  </ng-template>
  <ng-template #elseNoLocationsTemplate>
    <div>
      <h3>No locations added yet</h3>
    </div>
  </ng-template>
</div>
